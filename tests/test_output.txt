===== START OF ALL TESTS =====

===== Running tests with test_input.txt =====
===== RUNNING ALL TESTS =====

Running IO tests...
Testing input parser...
Input: "A1=10"
  Command Type: 0
  Cell: A1, Value/Ref: 10

Input: "B2=A1"
  Command Type: 0
  Cell: B2, Value/Ref: A1

Input: "C3=A1+B2"
  Command Type: 5
  Cell: C3, Expression: A1+B2, Operator: +

Input: "D4=SUM(A1:B2)"
  Command Type: 6
  Cell: D4, Function: 3, Expression: SUM(A1:B2)

Input: "E5=MIN(A1:C3)"
  Command Type: 6
  Cell: E5, Function: 1, Expression: MIN(A1:C3)

Input: "F6=SLEEP(5)"
  Command Type: 6
  Cell: F6, Function: 6, Expression: SLEEP(5)

Input: "scroll_to A1"
  Command Type: 1
  Scroll Target: A1

Input: "w"
  Command Type: 2
  Scroll Direction: w

Input: "disable_output"
  Command Type: 3
  Control Command: disable_output

Input: "q"
  Command Type: 3
  Control Command: q

Input: "invalid command"
  Command Type: 7
  Invalid Command

TEST_INPUT_PARSER is passed
Testing cell validation...
Validating cell: A1
Validation result: 1
Cell: "A1" is valid
Validating cell: Z10
Validation result: 1
Cell: "Z10" is valid
Validating cell: AA100
Validation result: 1
Cell: "AA100" is valid
Validating cell: AAA1000
Validation result: 0
Cell: "AAA1000" is invalid
Validating cell: A0
Validation result: 0
Cell: "A0" is invalid
Validating cell: 1A
Validation result: 0
Cell: "1A" is invalid
Validating cell: 
Validation result: 0
Cell: "" is invalid
Validating cell: A-1
Validation result: 0
Cell: "A-1" is invalid

TEST_CELL_VALIDATION is passed
Testing range validation...
Validating range: A1:B2
Validation result: 1
Range: "A1:B2" is valid
Validating range: A1:Z10
Validation result: 1
Range: "A1:Z10" is valid
Validating range: A1:
Validation result: 0
Range: "A1:" is invalid
Validating range: :B2
Validation result: 0
Range: ":B2" is invalid
Validating range: A1B2
Validation result: 0
Range: "A1B2" is invalid
Validating range: A0:B2
Validation result: 0
Range: "A0:B2" is invalid
Validating range: A1:B0
Validation result: 0
Range: "A1:B0" is invalid
Validating range: 
Validation result: 0
Range: "" is invalid

TEST_RANGE_VALIDATION is passed
Testing cell to row/column conversion...
Converting cell: A1
Row: 1, Column: 1
Cell: "A1" -> Row: 1, Col: 1
Converting cell: B2
Row: 2, Column: 2
Cell: "B2" -> Row: 2, Col: 2
Converting cell: Z26
Row: 26, Column: 26
Cell: "Z26" -> Row: 26, Col: 26
Converting cell: AA27
Row: 27, Column: 27
Cell: "AA27" -> Row: 27, Col: 27
Converting cell: AB28
Row: 28, Column: 28
Cell: "AB28" -> Row: 28, Col: 28

TEST_CELL_TO_RC is passed
All IO tests are passed.

Running process tests...
Testing assign function...
Assigning value 42 to A1
A1 value: 42
Assigning A1 to B2
B2 value: 42
Changing A1 to 100
A1 value: 100
B2 value after update: 100

TEST_ASSIGN is passed
Testing arithmetic function...
C3 = A1 + B2 (10 + 5)
C3 value: 15
D4 = A1 - B2 (10 - 5)
D4 value: 5
E5 = A1 * B2 (10 * 5)
E5 value: 50
F6 = A1 / B2 (10 / 5)
F6 value: 2
G7 = 20 + 3
G7 value: 23

TEST_ARITHMETIC is passed
Testing function operations...
C3 = SUM(A1:B2) (10+20+30+40)
C3 value: 100
D4 = MIN(A1:B2) (10)
D4 value: 10
E5 = MAX(A1:B2) (40)
E5 value: 40
F6 = AVG(A1:B2) (25)
F6 value: 25
G7 = STDEV(A1:B2)
G7 value: 13
H8 = SLEEP(1)
H8 value: 1

TEST_FUNCTION is passed
Testing error handling...
C3 = A1 / B2 (10 / 0)
C3 value: -999999 (should be ERROR_VALUE)
D4 = C3 (ERROR_VALUE)
D4 value: -999999 (should be ERROR_VALUE)
E5 = SUM(J10:E5) (invalid range - end before start)
Range validation correctly failed

TEST_ERROR_HANDLING is passed
All process tests are passed.

Running dependent tests...
Testing parent-child relationships...
Assigning A1 as parent of B2
Parent A1 found in B2's parent list: Yes
Child B2 found in A1's child list: Yes
Removing A1 as parent of B2
Parent A1 found in B2's parent list after removal: No
Child B2 found in A1's child list after removal: No

TEST_PARENT_CHILD_RELATIONSHIPS is passed
Testing cycle detection...
Setting A1 = B2
Setting B2 = C3
Cycle detected before adding C3 = A1: No
Attempting to set C3 = A1 (would create a cycle)
Cycle detected after adding C3 = A1: Yes

TEST_CYCLE_DETECTION is passed
Testing dependency updates...
Setting B2 = A1
Setting C3 = B2 + 5
Setting D4 = SUM(A1:C3)
Initial values:
  A1 = 10
  B2 = 10
  C3 = 15
  D4 = 35
Changing A1 to 20 and updating dependencies
Updated values:
  A1 = 20
  B2 = 10
  C3 = 15
  D4 = 45

TEST_DEPENDENCY_UPDATES is passed
All dependent tests are passed.

Running display tests...
Testing scrolling functions...
After scroll up from row 5: curr_org_r = 5
After scroll down: curr_org_r = 5
After scroll left from column 5: curr_org_c = 5
After scroll right: curr_org_c = 5
After scroll up from row 0: curr_org_r = 0
After scroll left from column 0: curr_org_c = 0
Scrolling tests completed.
Testing output control functions...
After disable_output: output_enabled = 0
After enable_output: output_enabled = 1
Output control tests completed.
Testing int_to_alpha function...
Column 1 =     A
Column 26 =     Z
Column 27 =    AA
Column 52 =    AZ
Column 702 =    ZZ
int_to_alpha tests completed.
All display tests are passed.

Running integration tests...
Testing complex dependencies...
Processing command: "A1=10"
Status after command: ok
Processing command: "B1=20"
Status after command: ok
Processing command: "C1=A1+B1"
Status after command: ok
Processing command: "D1=C1*2"
Status after command: ok
Processing command: "E1=SUM(A1:D1)"
Status after command: ok
Processing command: "F1=AVG(A1:E1)"
Status after command: ok
Initial values:
  A1 = 10
  B1 = 20
  C1 = 30
  D1 = 60
  E1 = 120
  F1 = 48
Processing command: "A1=15"
Status after command: ok
Values after changing A1 to 15:
  A1 = 15
  B1 = 20
  C1 = 30
  D1 = 60
  E1 = 120
  F1 = 48
Processing command: "B1=25"
Status after command: ok
Values after changing B1 to 25:
  A1 = 15
  B1 = 25
  C1 = 30
  D1 = 60
  E1 = 120
  F1 = 48

TEST_COMPLEX_DEPENDENCIES is passed
Processing command: "q"
Received quit command
Testing command processing...
Processing command: "A1=42"
Status after command: ok
A1 after direct assignment: 42
Processing command: "B1=A1"
Status after command: ok
B1 after reference assignment: 42
Processing command: "C1=A1+10"
Status after command: ok
C1 after A1+10: 52
Processing command: "D1=A1-10"
Status after command: ok
D1 after A1-10: 32
Processing command: "E1=A1*2"
Status after command: ok
E1 after A1*2: 84
Processing command: "F1=A1/2"
Status after command: ok
F1 after A1/2: 21
Processing command: "A2=MIN(A1:F1)"
Status after command: ok
A2 after MIN(A1:F1): 21
Processing command: "B2=MAX(A1:F1)"
Status after command: ok
B2 after MAX(A1:F1): 84
Processing command: "C2=SUM(A1:F1)"
Status after command: ok
C2 after SUM(A1:F1): 273
Processing command: "D2=AVG(A1:F1)"
Status after command: ok
D2 after AVG(A1:F1): 45
Processing command: "E2=STDEV(A1:F1)"
Status after command: ok
E2 after STDEV(A1:F1): 22
Processing command: "F2=SLEEP(1)"
Status after command: ok
F2 after SLEEP(1): 1
Processing command: "disable_output"
Status after command: ok
Output enabled after disable_output: false
Processing command: "enable_output"
Status after command: ok
Output enabled after enable_output: false
Processing command: "scroll_to B10"
Status after command: ok
Viewport position after scroll_to B10: Row 0, Col 0
Processing command: "w"
Status after command: ok
Viewport position after w: Row 0, Col 0

TEST_COMMAND_PROCESSING is passed
Testing error propagation...
Processing command: "A1=10"
Status after command: ok
Processing command: "B1=0"
Status after command: ok
Processing command: "C1=A1/B1"
Status after command: ok
Processing command: "D1=C1+5"
Status after command: ok
Processing command: "E1=SUM(A1:D1)"
Status after command: ok
Values after setting up error chain:
  A1 = 10
  B1 = 0
  C1 = -999999 (should be ERROR_VALUE)
  D1 = -999999 (should be ERROR_VALUE)
  E1 = -999999 (should be ERROR_VALUE)
Processing command: "B1=2"
Status after command: ok
Values after fixing B1:
  A1 = 10
  B1 = 2
  C1 = -999999
  D1 = -999999
  E1 = -999999
Testing cycle detection:
Processing command: "F1=G1"
Status after command: ok
Processing command: "G1=F1"
Status after command: err
Status after attempting to create cycle: err
F1 value: 0
G1 value: 0

TEST_ERROR_PROPAGATION is passed
All integration tests are passed.


===== Running tests with test_arithmetic.txt =====
===== RUNNING ALL TESTS =====

Running IO tests...
Testing input parser...
Input: "A1=10"
  Command Type: 0
  Cell: A1, Value/Ref: 10

Input: "B2=A1"
  Command Type: 0
  Cell: B2, Value/Ref: A1

Input: "C3=A1+B2"
  Command Type: 5
  Cell: C3, Expression: A1+B2, Operator: +

Input: "D4=SUM(A1:B2)"
  Command Type: 6
  Cell: D4, Function: 3, Expression: SUM(A1:B2)

Input: "E5=MIN(A1:C3)"
  Command Type: 6
  Cell: E5, Function: 1, Expression: MIN(A1:C3)

Input: "F6=SLEEP(5)"
  Command Type: 6
  Cell: F6, Function: 6, Expression: SLEEP(5)

Input: "scroll_to A1"
  Command Type: 1
  Scroll Target: A1

Input: "w"
  Command Type: 2
  Scroll Direction: w

Input: "disable_output"
  Command Type: 3
  Control Command: disable_output

Input: "q"
  Command Type: 3
  Control Command: q

Input: "invalid command"
  Command Type: 7
  Invalid Command

TEST_INPUT_PARSER is passed
Testing cell validation...
Validating cell: A1
Validation result: 1
Cell: "A1" is valid
Validating cell: Z10
Validation result: 1
Cell: "Z10" is valid
Validating cell: AA100
Validation result: 1
Cell: "AA100" is valid
Validating cell: AAA1000
Validation result: 0
Cell: "AAA1000" is invalid
Validating cell: A0
Validation result: 0
Cell: "A0" is invalid
Validating cell: 1A
Validation result: 0
Cell: "1A" is invalid
Validating cell: 
Validation result: 0
Cell: "" is invalid
Validating cell: A-1
Validation result: 0
Cell: "A-1" is invalid

TEST_CELL_VALIDATION is passed
Testing range validation...
Validating range: A1:B2
Validation result: 1
Range: "A1:B2" is valid
Validating range: A1:Z10
Validation result: 1
Range: "A1:Z10" is valid
Validating range: A1:
Validation result: 0
Range: "A1:" is invalid
Validating range: :B2
Validation result: 0
Range: ":B2" is invalid
Validating range: A1B2
Validation result: 0
Range: "A1B2" is invalid
Validating range: A0:B2
Validation result: 0
Range: "A0:B2" is invalid
Validating range: A1:B0
Validation result: 0
Range: "A1:B0" is invalid
Validating range: 
Validation result: 0
Range: "" is invalid

TEST_RANGE_VALIDATION is passed
Testing cell to row/column conversion...
Converting cell: A1
Row: 1, Column: 1
Cell: "A1" -> Row: 1, Col: 1
Converting cell: B2
Row: 2, Column: 2
Cell: "B2" -> Row: 2, Col: 2
Converting cell: Z26
Row: 26, Column: 26
Cell: "Z26" -> Row: 26, Col: 26
Converting cell: AA27
Row: 27, Column: 27
Cell: "AA27" -> Row: 27, Col: 27
Converting cell: AB28
Row: 28, Column: 28
Cell: "AB28" -> Row: 28, Col: 28

TEST_CELL_TO_RC is passed
All IO tests are passed.

Running process tests...
Testing assign function...
Assigning value 42 to A1
A1 value: 42
Assigning A1 to B2
B2 value: 42
Changing A1 to 100
A1 value: 100
B2 value after update: 100

TEST_ASSIGN is passed
Testing arithmetic function...
C3 = A1 + B2 (10 + 5)
C3 value: 15
D4 = A1 - B2 (10 - 5)
D4 value: 5
E5 = A1 * B2 (10 * 5)
E5 value: 50
F6 = A1 / B2 (10 / 5)
F6 value: 2
G7 = 20 + 3
G7 value: 23

TEST_ARITHMETIC is passed
Testing function operations...
C3 = SUM(A1:B2) (10+20+30+40)
C3 value: 100
D4 = MIN(A1:B2) (10)
D4 value: 10
E5 = MAX(A1:B2) (40)
E5 value: 40
F6 = AVG(A1:B2) (25)
F6 value: 25
G7 = STDEV(A1:B2)
G7 value: 13
H8 = SLEEP(1)
H8 value: 1

TEST_FUNCTION is passed
Testing error handling...
C3 = A1 / B2 (10 / 0)
C3 value: -999999 (should be ERROR_VALUE)
D4 = C3 (ERROR_VALUE)
D4 value: -999999 (should be ERROR_VALUE)
E5 = SUM(J10:E5) (invalid range - end before start)
Range validation correctly failed

TEST_ERROR_HANDLING is passed
All process tests are passed.

Running dependent tests...
Testing parent-child relationships...
Assigning A1 as parent of B2
Parent A1 found in B2's parent list: Yes
Child B2 found in A1's child list: Yes
Removing A1 as parent of B2
Parent A1 found in B2's parent list after removal: No
Child B2 found in A1's child list after removal: No

TEST_PARENT_CHILD_RELATIONSHIPS is passed
Testing cycle detection...
Setting A1 = B2
Setting B2 = C3
Cycle detected before adding C3 = A1: No
Attempting to set C3 = A1 (would create a cycle)
Cycle detected after adding C3 = A1: Yes

TEST_CYCLE_DETECTION is passed
Testing dependency updates...
Setting B2 = A1
Setting C3 = B2 + 5
Setting D4 = SUM(A1:C3)
Initial values:
  A1 = 10
  B2 = 10
  C3 = 15
  D4 = 35
Changing A1 to 20 and updating dependencies
Updated values:
  A1 = 20
  B2 = 10
  C3 = 15
  D4 = 45

TEST_DEPENDENCY_UPDATES is passed
All dependent tests are passed.

Running display tests...
Testing scrolling functions...
After scroll up from row 5: curr_org_r = 5
After scroll down: curr_org_r = 5
After scroll left from column 5: curr_org_c = 5
After scroll right: curr_org_c = 5
After scroll up from row 0: curr_org_r = 0
After scroll left from column 0: curr_org_c = 0
Scrolling tests completed.
Testing output control functions...
After disable_output: output_enabled = 0
After enable_output: output_enabled = 1
Output control tests completed.
Testing int_to_alpha function...
Column 1 =     A
Column 26 =     Z
Column 27 =    AA
Column 52 =    AZ
Column 702 =    ZZ
int_to_alpha tests completed.
All display tests are passed.

Running integration tests...
Testing complex dependencies...
Processing command: "A1=10"
Status after command: ok
Processing command: "B1=20"
Status after command: ok
Processing command: "C1=A1+B1"
Status after command: ok
Processing command: "D1=C1*2"
Status after command: ok
Processing command: "E1=SUM(A1:D1)"
Status after command: ok
Processing command: "F1=AVG(A1:E1)"
Status after command: ok
Initial values:
  A1 = 10
  B1 = 20
  C1 = 30
  D1 = 60
  E1 = 120
  F1 = 48
Processing command: "A1=15"
Status after command: ok
Values after changing A1 to 15:
  A1 = 15
  B1 = 20
  C1 = 30
  D1 = 60
  E1 = 120
  F1 = 48
Processing command: "B1=25"
Status after command: ok
Values after changing B1 to 25:
  A1 = 15
  B1 = 25
  C1 = 30
  D1 = 60
  E1 = 120
  F1 = 48

TEST_COMPLEX_DEPENDENCIES is passed
Processing command: "q"
Received quit command
Testing command processing...
Processing command: "A1=42"
Status after command: ok
A1 after direct assignment: 42
Processing command: "B1=A1"
Status after command: ok
B1 after reference assignment: 42
Processing command: "C1=A1+10"
Status after command: ok
C1 after A1+10: 52
Processing command: "D1=A1-10"
Status after command: ok
D1 after A1-10: 32
Processing command: "E1=A1*2"
Status after command: ok
E1 after A1*2: 84
Processing command: "F1=A1/2"
Status after command: ok
F1 after A1/2: 21
Processing command: "A2=MIN(A1:F1)"
Status after command: ok
A2 after MIN(A1:F1): 21
Processing command: "B2=MAX(A1:F1)"
Status after command: ok
B2 after MAX(A1:F1): 84
Processing command: "C2=SUM(A1:F1)"
Status after command: ok
C2 after SUM(A1:F1): 273
Processing command: "D2=AVG(A1:F1)"
Status after command: ok
D2 after AVG(A1:F1): 45
Processing command: "E2=STDEV(A1:F1)"
Status after command: ok
E2 after STDEV(A1:F1): 22
Processing command: "F2=SLEEP(1)"
Status after command: ok
F2 after SLEEP(1): 1
Processing command: "disable_output"
Status after command: ok
Output enabled after disable_output: false
Processing command: "enable_output"
Status after command: ok
Output enabled after enable_output: false
Processing command: "scroll_to B10"
Status after command: ok
Viewport position after scroll_to B10: Row 0, Col 0
Processing command: "w"
Status after command: ok
Viewport position after w: Row 0, Col 0

TEST_COMMAND_PROCESSING is passed
Testing error propagation...
Processing command: "A1=10"
Status after command: ok
Processing command: "B1=0"
Status after command: ok
Processing command: "C1=A1/B1"
Status after command: ok
Processing command: "D1=C1+5"
Status after command: ok
Processing command: "E1=SUM(A1:D1)"
Status after command: ok
Values after setting up error chain:
  A1 = 10
  B1 = 0
  C1 = -999999 (should be ERROR_VALUE)
  D1 = -999999 (should be ERROR_VALUE)
  E1 = -999999 (should be ERROR_VALUE)
Processing command: "B1=2"
Status after command: ok
Values after fixing B1:
  A1 = 10
  B1 = 2
  C1 = -999999
  D1 = -999999
  E1 = -999999
Testing cycle detection:
Processing command: "F1=G1"
Status after command: ok
Processing command: "G1=F1"
Status after command: err
Status after attempting to create cycle: err
F1 value: 0
G1 value: 0

TEST_ERROR_PROPAGATION is passed
All integration tests are passed.


===== Running tests with test_functions.txt =====
===== RUNNING ALL TESTS =====

Running IO tests...
Testing input parser...
Input: "A1=10"
  Command Type: 0
  Cell: A1, Value/Ref: 10

Input: "B2=A1"
  Command Type: 0
  Cell: B2, Value/Ref: A1

Input: "C3=A1+B2"
  Command Type: 5
  Cell: C3, Expression: A1+B2, Operator: +

Input: "D4=SUM(A1:B2)"
  Command Type: 6
  Cell: D4, Function: 3, Expression: SUM(A1:B2)

Input: "E5=MIN(A1:C3)"
  Command Type: 6
  Cell: E5, Function: 1, Expression: MIN(A1:C3)

Input: "F6=SLEEP(5)"
  Command Type: 6
  Cell: F6, Function: 6, Expression: SLEEP(5)

Input: "scroll_to A1"
  Command Type: 1
  Scroll Target: A1

Input: "w"
  Command Type: 2
  Scroll Direction: w

Input: "disable_output"
  Command Type: 3
  Control Command: disable_output

Input: "q"
  Command Type: 3
  Control Command: q

Input: "invalid command"
  Command Type: 7
  Invalid Command

TEST_INPUT_PARSER is passed
Testing cell validation...
Validating cell: A1
Validation result: 1
Cell: "A1" is valid
Validating cell: Z10
Validation result: 1
Cell: "Z10" is valid
Validating cell: AA100
Validation result: 1
Cell: "AA100" is valid
Validating cell: AAA1000
Validation result: 0
Cell: "AAA1000" is invalid
Validating cell: A0
Validation result: 0
Cell: "A0" is invalid
Validating cell: 1A
Validation result: 0
Cell: "1A" is invalid
Validating cell: 
Validation result: 0
Cell: "" is invalid
Validating cell: A-1
Validation result: 0
Cell: "A-1" is invalid

TEST_CELL_VALIDATION is passed
Testing range validation...
Validating range: A1:B2
Validation result: 1
Range: "A1:B2" is valid
Validating range: A1:Z10
Validation result: 1
Range: "A1:Z10" is valid
Validating range: A1:
Validation result: 0
Range: "A1:" is invalid
Validating range: :B2
Validation result: 0
Range: ":B2" is invalid
Validating range: A1B2
Validation result: 0
Range: "A1B2" is invalid
Validating range: A0:B2
Validation result: 0
Range: "A0:B2" is invalid
Validating range: A1:B0
Validation result: 0
Range: "A1:B0" is invalid
Validating range: 
Validation result: 0
Range: "" is invalid

TEST_RANGE_VALIDATION is passed
Testing cell to row/column conversion...
Converting cell: A1
Row: 1, Column: 1
Cell: "A1" -> Row: 1, Col: 1
Converting cell: B2
Row: 2, Column: 2
Cell: "B2" -> Row: 2, Col: 2
Converting cell: Z26
Row: 26, Column: 26
Cell: "Z26" -> Row: 26, Col: 26
Converting cell: AA27
Row: 27, Column: 27
Cell: "AA27" -> Row: 27, Col: 27
Converting cell: AB28
Row: 28, Column: 28
Cell: "AB28" -> Row: 28, Col: 28

TEST_CELL_TO_RC is passed
All IO tests are passed.

Running process tests...
Testing assign function...
Assigning value 42 to A1
A1 value: 42
Assigning A1 to B2
B2 value: 42
Changing A1 to 100
A1 value: 100
B2 value after update: 100

TEST_ASSIGN is passed
Testing arithmetic function...
C3 = A1 + B2 (10 + 5)
C3 value: 15
D4 = A1 - B2 (10 - 5)
D4 value: 5
E5 = A1 * B2 (10 * 5)
E5 value: 50
F6 = A1 / B2 (10 / 5)
F6 value: 2
G7 = 20 + 3
G7 value: 23

TEST_ARITHMETIC is passed
Testing function operations...
C3 = SUM(A1:B2) (10+20+30+40)
C3 value: 100
D4 = MIN(A1:B2) (10)
D4 value: 10
E5 = MAX(A1:B2) (40)
E5 value: 40
F6 = AVG(A1:B2) (25)
F6 value: 25
G7 = STDEV(A1:B2)
G7 value: 13
H8 = SLEEP(1)
H8 value: 1

TEST_FUNCTION is passed
Testing error handling...
C3 = A1 / B2 (10 / 0)
C3 value: -999999 (should be ERROR_VALUE)
D4 = C3 (ERROR_VALUE)
D4 value: -999999 (should be ERROR_VALUE)
E5 = SUM(J10:E5) (invalid range - end before start)
Range validation correctly failed

TEST_ERROR_HANDLING is passed
All process tests are passed.

Running dependent tests...
Testing parent-child relationships...
Assigning A1 as parent of B2
Parent A1 found in B2's parent list: Yes
Child B2 found in A1's child list: Yes
Removing A1 as parent of B2
Parent A1 found in B2's parent list after removal: No
Child B2 found in A1's child list after removal: No

TEST_PARENT_CHILD_RELATIONSHIPS is passed
Testing cycle detection...
Setting A1 = B2
Setting B2 = C3
Cycle detected before adding C3 = A1: No
Attempting to set C3 = A1 (would create a cycle)
Cycle detected after adding C3 = A1: Yes

TEST_CYCLE_DETECTION is passed
Testing dependency updates...
Setting B2 = A1
Setting C3 = B2 + 5
Setting D4 = SUM(A1:C3)
Initial values:
  A1 = 10
  B2 = 10
  C3 = 15
  D4 = 35
Changing A1 to 20 and updating dependencies
Updated values:
  A1 = 20
  B2 = 10
  C3 = 15
  D4 = 45

TEST_DEPENDENCY_UPDATES is passed
All dependent tests are passed.

Running display tests...
Testing scrolling functions...
After scroll up from row 5: curr_org_r = 5
After scroll down: curr_org_r = 5
After scroll left from column 5: curr_org_c = 5
After scroll right: curr_org_c = 5
After scroll up from row 0: curr_org_r = 0
After scroll left from column 0: curr_org_c = 0
Scrolling tests completed.
Testing output control functions...
After disable_output: output_enabled = 0
After enable_output: output_enabled = 1
Output control tests completed.
Testing int_to_alpha function...
Column 1 =     A
Column 26 =     Z
Column 27 =    AA
Column 52 =    AZ
Column 702 =    ZZ
int_to_alpha tests completed.
All display tests are passed.

Running integration tests...
Testing complex dependencies...
Processing command: "A1=10"
Status after command: ok
Processing command: "B1=20"
Status after command: ok
Processing command: "C1=A1+B1"
Status after command: ok
Processing command: "D1=C1*2"
Status after command: ok
Processing command: "E1=SUM(A1:D1)"
Status after command: ok
Processing command: "F1=AVG(A1:E1)"
Status after command: ok
Initial values:
  A1 = 10
  B1 = 20
  C1 = 30
  D1 = 60
  E1 = 120
  F1 = 48
Processing command: "A1=15"
Status after command: ok
Values after changing A1 to 15:
  A1 = 15
  B1 = 20
  C1 = 30
  D1 = 60
  E1 = 120
  F1 = 48
Processing command: "B1=25"
Status after command: ok
Values after changing B1 to 25:
  A1 = 15
  B1 = 25
  C1 = 30
  D1 = 60
  E1 = 120
  F1 = 48

TEST_COMPLEX_DEPENDENCIES is passed
Processing command: "q"
Received quit command
Testing command processing...
Processing command: "A1=42"
Status after command: ok
A1 after direct assignment: 42
Processing command: "B1=A1"
Status after command: ok
B1 after reference assignment: 42
Processing command: "C1=A1+10"
Status after command: ok
C1 after A1+10: 52
Processing command: "D1=A1-10"
Status after command: ok
D1 after A1-10: 32
Processing command: "E1=A1*2"
Status after command: ok
E1 after A1*2: 84
Processing command: "F1=A1/2"
Status after command: ok
F1 after A1/2: 21
Processing command: "A2=MIN(A1:F1)"
Status after command: ok
A2 after MIN(A1:F1): 21
Processing command: "B2=MAX(A1:F1)"
Status after command: ok
B2 after MAX(A1:F1): 84
Processing command: "C2=SUM(A1:F1)"
Status after command: ok
C2 after SUM(A1:F1): 273
Processing command: "D2=AVG(A1:F1)"
Status after command: ok
D2 after AVG(A1:F1): 45
Processing command: "E2=STDEV(A1:F1)"
Status after command: ok
E2 after STDEV(A1:F1): 22
Processing command: "F2=SLEEP(1)"
Status after command: ok
F2 after SLEEP(1): 1
Processing command: "disable_output"
Status after command: ok
Output enabled after disable_output: false
Processing command: "enable_output"
Status after command: ok
Output enabled after enable_output: false
Processing command: "scroll_to B10"
Status after command: ok
Viewport position after scroll_to B10: Row 0, Col 0
Processing command: "w"
Status after command: ok
Viewport position after w: Row 0, Col 0

TEST_COMMAND_PROCESSING is passed
Testing error propagation...
Processing command: "A1=10"
Status after command: ok
Processing command: "B1=0"
Status after command: ok
Processing command: "C1=A1/B1"
Status after command: ok
Processing command: "D1=C1+5"
Status after command: ok
Processing command: "E1=SUM(A1:D1)"
Status after command: ok
Values after setting up error chain:
  A1 = 10
  B1 = 0
  C1 = -999999 (should be ERROR_VALUE)
  D1 = -999999 (should be ERROR_VALUE)
  E1 = -999999 (should be ERROR_VALUE)
Processing command: "B1=2"
Status after command: ok
Values after fixing B1:
  A1 = 10
  B1 = 2
  C1 = -999999
  D1 = -999999
  E1 = -999999
Testing cycle detection:
Processing command: "F1=G1"
Status after command: ok
Processing command: "G1=F1"
Status after command: err
Status after attempting to create cycle: err
F1 value: 0
G1 value: 0

TEST_ERROR_PROPAGATION is passed
All integration tests are passed.


===== Running tests with test_dependencies.txt =====
===== RUNNING ALL TESTS =====

Running IO tests...
Testing input parser...
Input: "A1=10"
  Command Type: 0
  Cell: A1, Value/Ref: 10

Input: "B2=A1"
  Command Type: 0
  Cell: B2, Value/Ref: A1

Input: "C3=A1+B2"
  Command Type: 5
  Cell: C3, Expression: A1+B2, Operator: +

Input: "D4=SUM(A1:B2)"
  Command Type: 6
  Cell: D4, Function: 3, Expression: SUM(A1:B2)

Input: "E5=MIN(A1:C3)"
  Command Type: 6
  Cell: E5, Function: 1, Expression: MIN(A1:C3)

Input: "F6=SLEEP(5)"
  Command Type: 6
  Cell: F6, Function: 6, Expression: SLEEP(5)

Input: "scroll_to A1"
  Command Type: 1
  Scroll Target: A1

Input: "w"
  Command Type: 2
  Scroll Direction: w

Input: "disable_output"
  Command Type: 3
  Control Command: disable_output

Input: "q"
  Command Type: 3
  Control Command: q

Input: "invalid command"
  Command Type: 7
  Invalid Command

TEST_INPUT_PARSER is passed
Testing cell validation...
Validating cell: A1
Validation result: 1
Cell: "A1" is valid
Validating cell: Z10
Validation result: 1
Cell: "Z10" is valid
Validating cell: AA100
Validation result: 1
Cell: "AA100" is valid
Validating cell: AAA1000
Validation result: 0
Cell: "AAA1000" is invalid
Validating cell: A0
Validation result: 0
Cell: "A0" is invalid
Validating cell: 1A
Validation result: 0
Cell: "1A" is invalid
Validating cell: 
Validation result: 0
Cell: "" is invalid
Validating cell: A-1
Validation result: 0
Cell: "A-1" is invalid

TEST_CELL_VALIDATION is passed
Testing range validation...
Validating range: A1:B2
Validation result: 1
Range: "A1:B2" is valid
Validating range: A1:Z10
Validation result: 1
Range: "A1:Z10" is valid
Validating range: A1:
Validation result: 0
Range: "A1:" is invalid
Validating range: :B2
Validation result: 0
Range: ":B2" is invalid
Validating range: A1B2
Validation result: 0
Range: "A1B2" is invalid
Validating range: A0:B2
Validation result: 0
Range: "A0:B2" is invalid
Validating range: A1:B0
Validation result: 0
Range: "A1:B0" is invalid
Validating range: 
Validation result: 0
Range: "" is invalid

TEST_RANGE_VALIDATION is passed
Testing cell to row/column conversion...
Converting cell: A1
Row: 1, Column: 1
Cell: "A1" -> Row: 1, Col: 1
Converting cell: B2
Row: 2, Column: 2
Cell: "B2" -> Row: 2, Col: 2
Converting cell: Z26
Row: 26, Column: 26
Cell: "Z26" -> Row: 26, Col: 26
Converting cell: AA27
Row: 27, Column: 27
Cell: "AA27" -> Row: 27, Col: 27
Converting cell: AB28
Row: 28, Column: 28
Cell: "AB28" -> Row: 28, Col: 28

TEST_CELL_TO_RC is passed
All IO tests are passed.

Running process tests...
Testing assign function...
Assigning value 42 to A1
A1 value: 42
Assigning A1 to B2
B2 value: 42
Changing A1 to 100
A1 value: 100
B2 value after update: 100

TEST_ASSIGN is passed
Testing arithmetic function...
C3 = A1 + B2 (10 + 5)
C3 value: 15
D4 = A1 - B2 (10 - 5)
D4 value: 5
E5 = A1 * B2 (10 * 5)
E5 value: 50
F6 = A1 / B2 (10 / 5)
F6 value: 2
G7 = 20 + 3
G7 value: 23

TEST_ARITHMETIC is passed
Testing function operations...
C3 = SUM(A1:B2) (10+20+30+40)
C3 value: 100
D4 = MIN(A1:B2) (10)
D4 value: 10
E5 = MAX(A1:B2) (40)
E5 value: 40
F6 = AVG(A1:B2) (25)
F6 value: 25
G7 = STDEV(A1:B2)
G7 value: 13
H8 = SLEEP(1)
H8 value: 1

TEST_FUNCTION is passed
Testing error handling...
C3 = A1 / B2 (10 / 0)
C3 value: -999999 (should be ERROR_VALUE)
D4 = C3 (ERROR_VALUE)
D4 value: -999999 (should be ERROR_VALUE)
E5 = SUM(J10:E5) (invalid range - end before start)
Range validation correctly failed

TEST_ERROR_HANDLING is passed
All process tests are passed.

Running dependent tests...
Testing parent-child relationships...
Assigning A1 as parent of B2
Parent A1 found in B2's parent list: Yes
Child B2 found in A1's child list: Yes
Removing A1 as parent of B2
Parent A1 found in B2's parent list after removal: No
Child B2 found in A1's child list after removal: No

TEST_PARENT_CHILD_RELATIONSHIPS is passed
Testing cycle detection...
Setting A1 = B2
Setting B2 = C3
Cycle detected before adding C3 = A1: No
Attempting to set C3 = A1 (would create a cycle)
Cycle detected after adding C3 = A1: Yes

TEST_CYCLE_DETECTION is passed
Testing dependency updates...
Setting B2 = A1
Setting C3 = B2 + 5
Setting D4 = SUM(A1:C3)
Initial values:
  A1 = 10
  B2 = 10
  C3 = 15
  D4 = 35
Changing A1 to 20 and updating dependencies
Updated values:
  A1 = 20
  B2 = 10
  C3 = 15
  D4 = 45

TEST_DEPENDENCY_UPDATES is passed
All dependent tests are passed.

Running display tests...
Testing scrolling functions...
After scroll up from row 5: curr_org_r = 5
After scroll down: curr_org_r = 5
After scroll left from column 5: curr_org_c = 5
After scroll right: curr_org_c = 5
After scroll up from row 0: curr_org_r = 0
After scroll left from column 0: curr_org_c = 0
Scrolling tests completed.
Testing output control functions...
After disable_output: output_enabled = 0
After enable_output: output_enabled = 1
Output control tests completed.
Testing int_to_alpha function...
Column 1 =     A
Column 26 =     Z
Column 27 =    AA
Column 52 =    AZ
Column 702 =    ZZ
int_to_alpha tests completed.
All display tests are passed.

Running integration tests...
Testing complex dependencies...
Processing command: "A1=10"
Status after command: ok
Processing command: "B1=20"
Status after command: ok
Processing command: "C1=A1+B1"
Status after command: ok
Processing command: "D1=C1*2"
Status after command: ok
Processing command: "E1=SUM(A1:D1)"
Status after command: ok
Processing command: "F1=AVG(A1:E1)"
Status after command: ok
Initial values:
  A1 = 10
  B1 = 20
  C1 = 30
  D1 = 60
  E1 = 120
  F1 = 48
Processing command: "A1=15"
Status after command: ok
Values after changing A1 to 15:
  A1 = 15
  B1 = 20
  C1 = 30
  D1 = 60
  E1 = 120
  F1 = 48
Processing command: "B1=25"
Status after command: ok
Values after changing B1 to 25:
  A1 = 15
  B1 = 25
  C1 = 30
  D1 = 60
  E1 = 120
  F1 = 48

TEST_COMPLEX_DEPENDENCIES is passed
Processing command: "q"
Received quit command
Testing command processing...
Processing command: "A1=42"
Status after command: ok
A1 after direct assignment: 42
Processing command: "B1=A1"
Status after command: ok
B1 after reference assignment: 42
Processing command: "C1=A1+10"
Status after command: ok
C1 after A1+10: 52
Processing command: "D1=A1-10"
Status after command: ok
D1 after A1-10: 32
Processing command: "E1=A1*2"
Status after command: ok
E1 after A1*2: 84
Processing command: "F1=A1/2"
Status after command: ok
F1 after A1/2: 21
Processing command: "A2=MIN(A1:F1)"
Status after command: ok
A2 after MIN(A1:F1): 21
Processing command: "B2=MAX(A1:F1)"
Status after command: ok
B2 after MAX(A1:F1): 84
Processing command: "C2=SUM(A1:F1)"
Status after command: ok
C2 after SUM(A1:F1): 273
Processing command: "D2=AVG(A1:F1)"
Status after command: ok
D2 after AVG(A1:F1): 45
Processing command: "E2=STDEV(A1:F1)"
Status after command: ok
E2 after STDEV(A1:F1): 22
Processing command: "F2=SLEEP(1)"
Status after command: ok
F2 after SLEEP(1): 1
Processing command: "disable_output"
Status after command: ok
Output enabled after disable_output: false
Processing command: "enable_output"
Status after command: ok
Output enabled after enable_output: false
Processing command: "scroll_to B10"
Status after command: ok
Viewport position after scroll_to B10: Row 0, Col 0
Processing command: "w"
Status after command: ok
Viewport position after w: Row 0, Col 0

TEST_COMMAND_PROCESSING is passed
Testing error propagation...
Processing command: "A1=10"
Status after command: ok
Processing command: "B1=0"
Status after command: ok
Processing command: "C1=A1/B1"
Status after command: ok
Processing command: "D1=C1+5"
Status after command: ok
Processing command: "E1=SUM(A1:D1)"
Status after command: ok
Values after setting up error chain:
  A1 = 10
  B1 = 0
  C1 = -999999 (should be ERROR_VALUE)
  D1 = -999999 (should be ERROR_VALUE)
  E1 = -999999 (should be ERROR_VALUE)
Processing command: "B1=2"
Status after command: ok
Values after fixing B1:
  A1 = 10
  B1 = 2
  C1 = -999999
  D1 = -999999
  E1 = -999999
Testing cycle detection:
Processing command: "F1=G1"
Status after command: ok
Processing command: "G1=F1"
Status after command: err
Status after attempting to create cycle: err
F1 value: 0
G1 value: 0

TEST_ERROR_PROPAGATION is passed
All integration tests are passed.


===== Running tests with test_navigation.txt =====
===== RUNNING ALL TESTS =====

Running IO tests...
Testing input parser...
Input: "A1=10"
  Command Type: 0
  Cell: A1, Value/Ref: 10

Input: "B2=A1"
  Command Type: 0
  Cell: B2, Value/Ref: A1

Input: "C3=A1+B2"
  Command Type: 5
  Cell: C3, Expression: A1+B2, Operator: +

Input: "D4=SUM(A1:B2)"
  Command Type: 6
  Cell: D4, Function: 3, Expression: SUM(A1:B2)

Input: "E5=MIN(A1:C3)"
  Command Type: 6
  Cell: E5, Function: 1, Expression: MIN(A1:C3)

Input: "F6=SLEEP(5)"
  Command Type: 6
  Cell: F6, Function: 6, Expression: SLEEP(5)

Input: "scroll_to A1"
  Command Type: 1
  Scroll Target: A1

Input: "w"
  Command Type: 2
  Scroll Direction: w

Input: "disable_output"
  Command Type: 3
  Control Command: disable_output

Input: "q"
  Command Type: 3
  Control Command: q

Input: "invalid command"
  Command Type: 7
  Invalid Command

TEST_INPUT_PARSER is passed
Testing cell validation...
Validating cell: A1
Validation result: 1
Cell: "A1" is valid
Validating cell: Z10
Validation result: 1
Cell: "Z10" is valid
Validating cell: AA100
Validation result: 1
Cell: "AA100" is valid
Validating cell: AAA1000
Validation result: 0
Cell: "AAA1000" is invalid
Validating cell: A0
Validation result: 0
Cell: "A0" is invalid
Validating cell: 1A
Validation result: 0
Cell: "1A" is invalid
Validating cell: 
Validation result: 0
Cell: "" is invalid
Validating cell: A-1
Validation result: 0
Cell: "A-1" is invalid

TEST_CELL_VALIDATION is passed
Testing range validation...
Validating range: A1:B2
Validation result: 1
Range: "A1:B2" is valid
Validating range: A1:Z10
Validation result: 1
Range: "A1:Z10" is valid
Validating range: A1:
Validation result: 0
Range: "A1:" is invalid
Validating range: :B2
Validation result: 0
Range: ":B2" is invalid
Validating range: A1B2
Validation result: 0
Range: "A1B2" is invalid
Validating range: A0:B2
Validation result: 0
Range: "A0:B2" is invalid
Validating range: A1:B0
Validation result: 0
Range: "A1:B0" is invalid
Validating range: 
Validation result: 0
Range: "" is invalid

TEST_RANGE_VALIDATION is passed
Testing cell to row/column conversion...
Converting cell: A1
Row: 1, Column: 1
Cell: "A1" -> Row: 1, Col: 1
Converting cell: B2
Row: 2, Column: 2
Cell: "B2" -> Row: 2, Col: 2
Converting cell: Z26
Row: 26, Column: 26
Cell: "Z26" -> Row: 26, Col: 26
Converting cell: AA27
Row: 27, Column: 27
Cell: "AA27" -> Row: 27, Col: 27
Converting cell: AB28
Row: 28, Column: 28
Cell: "AB28" -> Row: 28, Col: 28

TEST_CELL_TO_RC is passed
All IO tests are passed.

Running process tests...
Testing assign function...
Assigning value 42 to A1
A1 value: 42
Assigning A1 to B2
B2 value: 42
Changing A1 to 100
A1 value: 100
B2 value after update: 100

TEST_ASSIGN is passed
Testing arithmetic function...
C3 = A1 + B2 (10 + 5)
C3 value: 15
D4 = A1 - B2 (10 - 5)
D4 value: 5
E5 = A1 * B2 (10 * 5)
E5 value: 50
F6 = A1 / B2 (10 / 5)
F6 value: 2
G7 = 20 + 3
G7 value: 23

TEST_ARITHMETIC is passed
Testing function operations...
C3 = SUM(A1:B2) (10+20+30+40)
C3 value: 100
D4 = MIN(A1:B2) (10)
D4 value: 10
E5 = MAX(A1:B2) (40)
E5 value: 40
F6 = AVG(A1:B2) (25)
F6 value: 25
G7 = STDEV(A1:B2)
G7 value: 13
H8 = SLEEP(1)
H8 value: 1

TEST_FUNCTION is passed
Testing error handling...
C3 = A1 / B2 (10 / 0)
C3 value: -999999 (should be ERROR_VALUE)
D4 = C3 (ERROR_VALUE)
D4 value: -999999 (should be ERROR_VALUE)
E5 = SUM(J10:E5) (invalid range - end before start)
Range validation correctly failed

TEST_ERROR_HANDLING is passed
All process tests are passed.

Running dependent tests...
Testing parent-child relationships...
Assigning A1 as parent of B2
Parent A1 found in B2's parent list: Yes
Child B2 found in A1's child list: Yes
Removing A1 as parent of B2
Parent A1 found in B2's parent list after removal: No
Child B2 found in A1's child list after removal: No

TEST_PARENT_CHILD_RELATIONSHIPS is passed
Testing cycle detection...
Setting A1 = B2
Setting B2 = C3
Cycle detected before adding C3 = A1: No
Attempting to set C3 = A1 (would create a cycle)
Cycle detected after adding C3 = A1: Yes

TEST_CYCLE_DETECTION is passed
Testing dependency updates...
Setting B2 = A1
Setting C3 = B2 + 5
Setting D4 = SUM(A1:C3)
Initial values:
  A1 = 10
  B2 = 10
  C3 = 15
  D4 = 35
Changing A1 to 20 and updating dependencies
Updated values:
  A1 = 20
  B2 = 10
  C3 = 15
  D4 = 45

TEST_DEPENDENCY_UPDATES is passed
All dependent tests are passed.

Running display tests...
Testing scrolling functions...
After scroll up from row 5: curr_org_r = 5
After scroll down: curr_org_r = 5
After scroll left from column 5: curr_org_c = 5
After scroll right: curr_org_c = 5
After scroll up from row 0: curr_org_r = 0
After scroll left from column 0: curr_org_c = 0
Scrolling tests completed.
Testing output control functions...
After disable_output: output_enabled = 0
After enable_output: output_enabled = 1
Output control tests completed.
Testing int_to_alpha function...
Column 1 =     A
Column 26 =     Z
Column 27 =    AA
Column 52 =    AZ
Column 702 =    ZZ
int_to_alpha tests completed.
All display tests are passed.

Running integration tests...
Testing complex dependencies...
Processing command: "A1=10"
Status after command: ok
Processing command: "B1=20"
Status after command: ok
Processing command: "C1=A1+B1"
Status after command: ok
Processing command: "D1=C1*2"
Status after command: ok
Processing command: "E1=SUM(A1:D1)"
Status after command: ok
Processing command: "F1=AVG(A1:E1)"
Status after command: ok
Initial values:
  A1 = 10
  B1 = 20
  C1 = 30
  D1 = 60
  E1 = 120
  F1 = 48
Processing command: "A1=15"
Status after command: ok
Values after changing A1 to 15:
  A1 = 15
  B1 = 20
  C1 = 30
  D1 = 60
  E1 = 120
  F1 = 48
Processing command: "B1=25"
Status after command: ok
Values after changing B1 to 25:
  A1 = 15
  B1 = 25
  C1 = 30
  D1 = 60
  E1 = 120
  F1 = 48

TEST_COMPLEX_DEPENDENCIES is passed
Processing command: "q"
Received quit command
Testing command processing...
Processing command: "A1=42"
Status after command: ok
A1 after direct assignment: 42
Processing command: "B1=A1"
Status after command: ok
B1 after reference assignment: 42
Processing command: "C1=A1+10"
Status after command: ok
C1 after A1+10: 52
Processing command: "D1=A1-10"
Status after command: ok
D1 after A1-10: 32
Processing command: "E1=A1*2"
Status after command: ok
E1 after A1*2: 84
Processing command: "F1=A1/2"
Status after command: ok
F1 after A1/2: 21
Processing command: "A2=MIN(A1:F1)"
Status after command: ok
A2 after MIN(A1:F1): 21
Processing command: "B2=MAX(A1:F1)"
Status after command: ok
B2 after MAX(A1:F1): 84
Processing command: "C2=SUM(A1:F1)"
Status after command: ok
C2 after SUM(A1:F1): 273
Processing command: "D2=AVG(A1:F1)"
Status after command: ok
D2 after AVG(A1:F1): 45
Processing command: "E2=STDEV(A1:F1)"
Status after command: ok
E2 after STDEV(A1:F1): 22
Processing command: "F2=SLEEP(1)"
Status after command: ok
F2 after SLEEP(1): 1
Processing command: "disable_output"
Status after command: ok
Output enabled after disable_output: false
Processing command: "enable_output"
Status after command: ok
Output enabled after enable_output: false
Processing command: "scroll_to B10"
Status after command: ok
Viewport position after scroll_to B10: Row 0, Col 0
Processing command: "w"
Status after command: ok
Viewport position after w: Row 0, Col 0

TEST_COMMAND_PROCESSING is passed
Testing error propagation...
Processing command: "A1=10"
Status after command: ok
Processing command: "B1=0"
Status after command: ok
Processing command: "C1=A1/B1"
Status after command: ok
Processing command: "D1=C1+5"
Status after command: ok
Processing command: "E1=SUM(A1:D1)"
Status after command: ok
Values after setting up error chain:
  A1 = 10
  B1 = 0
  C1 = -999999 (should be ERROR_VALUE)
  D1 = -999999 (should be ERROR_VALUE)
  E1 = -999999 (should be ERROR_VALUE)
Processing command: "B1=2"
Status after command: ok
Values after fixing B1:
  A1 = 10
  B1 = 2
  C1 = -999999
  D1 = -999999
  E1 = -999999
Testing cycle detection:
Processing command: "F1=G1"
Status after command: ok
Processing command: "G1=F1"
Status after command: err
Status after attempting to create cycle: err
F1 value: 0
G1 value: 0

TEST_ERROR_PROPAGATION is passed
All integration tests are passed.

===== END OF ALL TESTS =====
