===== RUNNING IO TESTS =====
Testing input_parser function...
Input: "A1=10"
  Command Type: 0
  Cell: A1, Value/Ref: 10

Input: "B2=A1"
  Command Type: 0
  Cell: B2, Value/Ref: A1

Input: "C3=A1+B2"
  Command Type: 5
  Cell: C3, Expression: A1+B2, Operator: +

Input: "D4=SUM(A1:B2)"
  Command Type: 6
  Cell: D4, Function: 3, Expression: SUM(A1:B2)

Input: "E5=MIN(A1:C3)"
  Command Type: 6
  Cell: E5, Function: 1, Expression: MIN(A1:C3)

Input: "F6=SLEEP(5)"
  Command Type: 6
  Cell: F6, Function: 6, Expression: SLEEP(5)

Input: "scroll_to A1"
  Command Type: 1
  Scroll Target: A1

Input: "w"
  Command Type: 2
  Scroll Direction: w

Input: "disable_output"
  Command Type: 3
  Control Command: disable_output

Input: "q"
  Command Type: 3
  Control Command: q

Input: "invalid command"
  Command Type: 7
  Invalid Command

Testing cell validation...
Cell: "A1" is valid
Cell: "Z10" is valid
Cell: "AA100" is valid
Cell: "AAA1000" is invalid
Cell: "A0" is invalid
Cell: "1A" is invalid
Cell: "" is invalid
Cell: "A-1" is invalid

Testing range validation...
Range: "A1:B2" is valid
Range: "A1:Z10" is valid
Range: "A1:" is invalid
Range: ":B2" is invalid
Range: "A1B2" is invalid
Range: "A0:B2" is invalid
Range: "A1:B0" is invalid
Range: "" is invalid

Testing cell_to_rc function...
Cell: "A1" -> Row: 1, Col: 1
Cell: "B2" -> Row: 2, Col: 2
Cell: "Z26" -> Row: 26, Col: 26
Cell: "AA27" -> Row: 27, Col: 27
Cell: "AB28" -> Row: 28, Col: 28


===== RUNNING PROCESS TESTS =====
Testing assign function...
Assigning value 42 to A1
A1 value: 42
Assigning A1 to B2
B2 value: 42
Changing A1 to 100
A1 value: 100
B2 value after update: 100

Testing arithmetic function...
C3 = A1 + B2 (10 + 5)
C3 value: 15
D4 = A1 - B2 (10 - 5)
D4 value: 5
E5 = A1 * B2 (10 * 5)
E5 value: 50
F6 = A1 / B2 (10 / 5)
F6 value: 2
G7 = 20 + 3
G7 value: 23

Testing function operations...
C3 = SUM(A1:B2) (10+20+30+40)
C3 value: 100
D4 = MIN(A1:B2) (10)
D4 value: 10
E5 = MAX(A1:B2) (40)
E5 value: 40
F6 = AVG(A1:B2) (25)
F6 value: 25
G7 = STDEV(A1:B2)
G7 value: 13
H8 = SLEEP(1)
H8 value: 1

Testing error handling...
C3 = A1 / B2 (10 / 0)
C3 value: -2147483648 (should be ERROR_VALUE)
D4 = C3 (ERROR_VALUE)
D4 value: -2147483648 (should be ERROR_VALUE)
E5 = SUM(J10:E5) (invalid range - end before start)
Range validation correctly failed


===== RUNNING DEPENDENT TESTS =====
Testing parent-child relationships...
Assigning A1 as parent of B2
Parent A1 found in B2's parent list: Yes
Child B2 found in A1's child list: Yes
Removing A1 as parent of B2
Parent A1 found in B2's parent list after removal: Yes
Child B2 found in A1's child list after removal: Yes

Testing cycle detection...
Setting A1 = B2
Setting B2 = C3
Cycle detected before adding C3 = A1: No
Attempting to set C3 = A1 (would create a cycle)
Cycle detected after adding C3 = A1: Yes

Testing dependency updates...
Setting B2 = A1
Setting C3 = B2 + 5
Setting D4 = SUM(A1:C3)
Initial values:
  A1 = 10
  B2 = 10
  C3 = 15
  D4 = 35
Changing A1 to 20 and updating dependencies
Updated values:
  A1 = 20
  B2 = 10
  C3 = 15
  D4 = 45


===== RUNNING DISPLAY TESTS =====
Testing scrolling functions...
Initial position: Row 1, Col 1
Setting viewport to Row 5, Col 5
New position: Row 5, Col 5
Scrolling 3 rows down, 2 columns right
New position: Row 8, Col 7
Testing w() - scroll up
New position: Row 1, Col 7
Testing s() - scroll down
New position: Row 11, Col 7
Testing a() - scroll left
New position: Row 11, Col 1
Testing d() - scroll right
New position: Row 11, Col 11
Testing boundary conditions
Setting viewport to Row 1, Col 1 (minimum)
New position: Row 1, Col 1
Attempting to scroll up and left from minimum position
Position after attempt: Row 1, Col 1
Setting viewport to maximum position
Position after setting to max: Row 990, Col 18269
Attempting to scroll down and right from maximum position
Position after attempt: Row 990, Col 18269

Testing output control functions...
Initial output state: enabled
Disabling output
Output state after disable: disabled
Was disabled flag: true
Setting viewport to Row 10, Col 10 while output is disabled
Current position: Row 990, Col 18269
Pending scroll should be stored but not applied
Enabling output
Output state after enable: enabled
Position after enabling output: Row 10, Col 10
Pending scroll should now be applied

Testing int_to_alpha function...
Column 1 -> "A" (expected "A")
Column 2 -> "B" (expected "B")
Column 26 -> "Z" (expected "Z")
Column 27 -> "AA" (expected "AA")
Column 28 -> "AB" (expected "AB")
Column 52 -> "AZ" (expected "AZ")
Column 53 -> "BA" (expected "BA")
Column 702 -> "ZZ" (expected "ZZ")


===== RUNNING INTEGRATION TESTS =====
Testing complex dependencies...
Processing command: "A1=10"
Status after command: err
Processing command: "B1=20"
Status after command: err
Processing command: "C1=A1+B1"
Status after command: err
Processing command: "D1=C1*2"
Status after command: err
Processing command: "E1=SUM(A1:D1)"
Status after command: err
Processing command: "F1=AVG(A1:E1)"
Status after command: err
Initial values:
  A1 = 10
  B1 = 20
  C1 = 30
  D1 = 60
  E1 = 120
  F1 = 48
Processing command: "A1=15"
Status after command: err
Values after changing A1 to 15:
  A1 = 15
  B1 = 20
  C1 = 30
  D1 = 60
  E1 = 120
  F1 = 49
Processing command: "B1=25"
Status after command: err
Values after changing B1 to 25:
  A1 = 15
  B1 = 25
  C1 = 30
  D1 = 60
  E1 = 120
  F1 = 50

Testing command processing...
Processing command: "A1=42"
Status after command: err
A1 after direct assignment: 42
Processing command: "B1=A1"
Status after command: err
B1 after reference assignment: 42
Processing command: "C1=A1+10"
Status after command: err
C1 after A1+10: 52
Processing command: "D1=A1-10"
Status after command: err
D1 after A1-10: 32
Processing command: "E1=A1*2"
Status after command: err
E1 after A1*2: 84
Processing command: "F1=A1/2"
Status after command: err
F1 after A1/2: 21
Processing command: "A2=MIN(A1:F1)"
Status after command: err
A2 after MIN(A1:F1): 21
Processing command: "B2=MAX(A1:F1)"
Status after command: err
B2 after MAX(A1:F1): 84
Processing command: "C2=SUM(A1:F1)"
Status after command: err
C2 after SUM(A1:F1): 273
Processing command: "D2=AVG(A1:F1)"
Status after command: err
D2 after AVG(A1:F1): 45
Processing command: "E2=STDEV(A1:F1)"
Status after command: err
E2 after STDEV(A1:F1): 22
Processing command: "F2=SLEEP(1)"
Status after command: err
F2 after SLEEP(1): 1
Processing command: "disable_output"
Status after command: err
Output enabled after disable_output: false
Processing command: "enable_output"
Status after command: err
Output enabled after enable_output: true
Processing command: "scroll_to B10"
Status after command: err
Viewport position after scroll_to B10: Row 10, Col 2
Processing command: "w"
Status after command: err
Viewport position after w: Row 1, Col 2

Testing error propagation...
Processing command: "A1=10"
Status after command: err
Processing command: "B1=0"
Status after command: err
Processing command: "C1=A1/B1"
Status after command: err
Processing command: "D1=C1+5"
Status after command: err
Processing command: "E1=SUM(A1:D1)"
Status after command: err
Values after setting up error chain:
  A1 = 10
  B1 = 0
  C1 = -2147483648 (should be ERROR_VALUE)
  D1 = -2147483648 (should be ERROR_VALUE)
  E1 = -2147483648 (should be ERROR_VALUE)
Processing command: "B1=2"
Status after command: err
Values after fixing B1:
  A1 = 10
  B1 = 2
  C1 = -2147483648
  D1 = -2147483648
  E1 = -2147483648
Testing cycle detection:
Processing command: "F1=G1"
Status after command: err
Processing command: "G1=F1"
Status after command: err
Status after attempting to create cycle: err
F1 value: 0
G1 value: 0

